
<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <link rel="shortcut icon" href="../../assets/images/favicon.png">
      
      <meta name="generator" content="mkdocs-0.16.2, mkdocs-material-1.7.5">
    
    
      
        <title>Copias de seguridad - Documentación de administración de NFMS4REDD</title>
      
    
    
      <script src="../../assets/javascripts/modernizr-1df76c4e58.js"></script>
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application-769c285a91.css">
      
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
  
  
  
    <body>
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <a href="../.." title="Documentación de administración de NFMS4REDD" class="md-icon md-icon--home md-header-nav__button">
          </a>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Instalación del servidor
                </span>
              
            
            Copias de seguridad
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">close</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result" data-md-lang-search="">
          <div class="md-search-result__meta" data-md-lang-result-none="No matching documents" data-md-lang-result-one="1 matching document" data-md-lang-result-other="# matching documents">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    
      <i class="md-icon md-icon--home md-nav__button"></i>
    
    Documentación de administración de NFMS4REDD
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Introducción" class="md-nav__link">
      Introducción
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../inventory/" title="Inventario" class="md-nav__link">
      Inventario
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Instalación del servidor
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Instalación del servidor
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../docker/" title="Instalación con Docker" class="md-nav__link">
      Instalación con Docker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../packages/" title="Instalación con paquetes" class="md-nav__link">
      Instalación con paquetes
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Copias de seguridad
      </label>
    
    <a href="./" title="Copias de seguridad" class="md-nav__link md-nav__link--active">
      Copias de seguridad
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#postgresql" title="PostgreSQL" class="md-nav__link">
    PostgreSQL
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geoserver" title="GeoServer" class="md-nav__link">
    GeoServer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#portal" title="Portal" class="md-nav__link">
    Portal
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../performance/" title="Rendimiento" class="md-nav__link">
      Rendimiento
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../postgis/" title="Carga de datos en PostGIS" class="md-nav__link">
      Carga de datos en PostGIS
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../geoserver/" title="Publicación de datos en GeoServer" class="md-nav__link">
      Publicación de datos en GeoServer
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Configuración del portal
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Configuración del portal
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../config/portal/" title="Configuración del portal" class="md-nav__link">
      Configuración del portal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../config/temporal/" title="Configuración de capas temporales" class="md-nav__link">
      Configuración de capas temporales
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../config/raster_temporal/" title="Configuración de capas raster temporales" class="md-nav__link">
      Configuración de capas raster temporales
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../optimization/" title="Optimizaciones" class="md-nav__link">
      Optimizaciones
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#postgresql" title="PostgreSQL" class="md-nav__link">
    PostgreSQL
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geoserver" title="GeoServer" class="md-nav__link">
    GeoServer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#portal" title="Portal" class="md-nav__link">
    Portal
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Copias de seguridad</h1>
                
                <h2 id="postgresql">PostgreSQL</h2>
<p>Ver documentación en <a href="https://geotalleres.readthedocs.io/es/latest/postgresql/postgresql.html#creacion-de-copias-de-seguridad">GeoTalleres</a>.</p>
<h2 id="geoserver">GeoServer</h2>
<p>Ver documentación en <a href="https://geotalleres.readthedocs.io/es/latest/geoserver-backup/geoserver_backup.html">GeoTalleres</a>, teniendo en cuenta que la instalación estándar del sistema establece <code>/var/nfms/geoserver</code> como directorio de datos de GeoServer.</p>
<h2 id="portal">Portal</h2>
<p>Las copias de seguridad de la configuración del portal son muy similares a las de GeoServer ya que la configuración está almacenada también en un directorio, generalmente <code>/var/nfms/geoladris</code>.</p>
<p>Además, es conveniente guardar una copia del fichero <code>.war</code> del portal, de forma que se pueda repetir la instalación utilizando exactamente el mismo software en caso necesario.</p>
<p>Para realizar una copia de seguridad, es necesario copiar este directorio, comprimido por comodidad y optimización de espacio, a algún lugar fuera del servidor. Los siguientes comandos crearían una copia de la configuración en el fichero <code>/tmp/portal-backup.tar.gz</code>:</p>
<div class="codehilite"><pre><span></span><span class="nb">cd</span> /var/nfms/geoladris
tar -czvf /tmp/portal-backup.tar.gz *
</pre></div>


<p>Las opciones <code>-czvf</code> especificadas significan:</p>
<ul>
<li>c: crear</li>
<li>z: comprimir en zip</li>
<li>v: verbose, muestra por pantalla los ficheros que se incluyen en la copia de seguridad</li>
<li>f: fichero resultante, especificado a continuación</li>
</ul>
<blockquote>
<p><strong>IMPORTANTE</strong>: Se deben guardar los ficheros con la copia de seguridad en una máquina distinta al servidor que alberga el portal, ya que en caso de que haya algún problema con dicha máquina se pueden perder también las copias.</p>
</blockquote>
<p>Para recuperar la configuración sólo tenemos que reemplazar el directorio <code>/var/nfms/geoladris</code> por los contenidos del fichero que contiene la copia. Para ello se puede descomprimir la copia de seguridad en un directorio temporal:</p>
<div class="codehilite"><pre><span></span>mkdir /tmp/copia
tar -xzvf /tmp/portal-backup.tgz --directory<span class="o">=</span>/tmp/copia
</pre></div>


<p>A diferencia del comando <code>tar</code> que utilizamos para crear la copia de seguridad, ahora estamos usando la opción <code>x</code> (extraer) en lugar de <code>c</code> (crear) y estamos especificando con la opción <code>--directory</code> que queremos extraer la copia en el directorio <code>/tmp/copia</code>.</p>
<p>Una vez descomprimido sólo hay que reemplazar los contenidos del directorio <code>/var/nfms/geoladris</code> por los del directorio <code>/tmp/copia</code>. Por seguridad, mantendremos los contenidos anteriores en <code>/tmp</code>:</p>
<div class="codehilite"><pre><span></span>sudo mv /var/nfms/geoladris /tmp/geoladris.bak
sudo mv /tmp/copia /var/nfms/geoladris
</pre></div>


<p>Por último quedaría reiniciar el portal:</p>
<div class="codehilite"><pre><span></span><span class="nb">cd</span> /var/nfms
docker-compose restart portal
</pre></div>


<p>o, si se ha instalado mediante paquetes:</p>
<div class="codehilite"><pre><span></span>sudo service tomcat7 restart
</pre></div>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../packages/" title="Instalación con paquetes" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Instalación con paquetes
              </span>
            </div>
          </a>
        
        
          <a href="../performance/" title="Rendimiento" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Rendimiento
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application-07b0fbb49b.js"></script>
      
      
      <script>app.initialize({url:{base:"../.."}})</script>
      
    
    
      
    
  </body>
</html>