
<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <link rel="shortcut icon" href="../assets/images/favicon.png">
      
      <meta name="generator" content="mkdocs-0.16.2, mkdocs-material-1.7.5">
    
    
      
        <title>Configuración del portal - Documentación de administración de NFMS4REDD</title>
      
    
    
      <script src="../assets/javascripts/modernizr-1df76c4e58.js"></script>
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application-769c285a91.css">
      
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
  
  
  
    <body>
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <a href=".." title="Documentación de administración de NFMS4REDD" class="md-icon md-icon--home md-header-nav__button">
          </a>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
            
            Configuración del portal
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">close</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result" data-md-lang-search="">
          <div class="md-search-result__meta" data-md-lang-result-none="No matching documents" data-md-lang-result-one="1 matching document" data-md-lang-result-other="# matching documents">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    
      <i class="md-icon md-icon--home md-nav__button"></i>
    
    Documentación de administración de NFMS4REDD
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Introducción" class="md-nav__link">
      Introducción
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../inventory/" title="Inventario" class="md-nav__link">
      Inventario
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Instalación del servidor
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Instalación del servidor
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../install/docker/" title="Instalación con Docker" class="md-nav__link">
      Instalación con Docker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../install/packages/" title="Instalación con paquetes" class="md-nav__link">
      Instalación con paquetes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../install/backups/" title="Copias de seguridad" class="md-nav__link">
      Copias de seguridad
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../install/performance/" title="Rendimiento" class="md-nav__link">
      Rendimiento
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../postgis/" title="Carga de datos en PostGIS" class="md-nav__link">
      Carga de datos en PostGIS
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../geoserver/" title="Publicación de datos en GeoServer" class="md-nav__link">
      Publicación de datos en GeoServer
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Configuración del portal
      </label>
    
    <a href="./" title="Configuración del portal" class="md-nav__link md-nav__link--active">
      Configuración del portal
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configuracion-de-una-nueva-capa" title="Configuración de una nueva capa" class="md-nav__link">
    Configuración de una nueva capa
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conexion-wms" title="Conexión WMS" class="md-nav__link">
    Conexión WMS
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#capas-del-portal" title="Capas del portal" class="md-nav__link">
    Capas del portal
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#grupos" title="Grupos" class="md-nav__link">
    Grupos
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuracion-de-un-nuevo-grupo-de-capas" title="Configuración de un nuevo grupo de capas" class="md-nav__link">
    Configuración de un nuevo grupo de capas
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../optimization/" title="Optimizaciones" class="md-nav__link">
      Optimizaciones
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configuracion-de-una-nueva-capa" title="Configuración de una nueva capa" class="md-nav__link">
    Configuración de una nueva capa
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conexion-wms" title="Conexión WMS" class="md-nav__link">
    Conexión WMS
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#capas-del-portal" title="Capas del portal" class="md-nav__link">
    Capas del portal
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#grupos" title="Grupos" class="md-nav__link">
    Grupos
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuracion-de-un-nuevo-grupo-de-capas" title="Configuración de un nuevo grupo de capas" class="md-nav__link">
    Configuración de un nuevo grupo de capas
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Configuración del portal</h1>
                
                <table>
<thead>
<tr>
<th>Fecha</th>
<th>Autores</th>
</tr>
</thead>
<tbody>
<tr>
<td>1 Noviembre 2012</td>
<td>Stefano Giaccio (Stefano.Giaccio@fao.org)</td>
</tr>
<tr>
<td>1 Diciembre 2012</td>
<td>Oscar Fonts (oscar.fonts@geomati.co)</td>
</tr>
<tr>
<td>24 Junio 2013</td>
<td>Fernando González (fernando.gonzalez@fao.org)</td>
</tr>
<tr>
<td>15 Enero 2018</td>
<td>Michio García (micho.garcia@geomati.co)</td>
</tr>
</tbody>
</table>
<blockquote>
<p>©2013 FAO Forestry</p>
<p>Excepto donde quede reflejado de otra manera, la presente documentación se halla bajo licencia : <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.es">Creative Commons</a></p>
</blockquote>
<p>Para configurar el portal y adaptarlo a cada pais se tendrá que realizar cierta modificaciones en la estructura de la aplicación instalada. El proceso de configuración se podrá seguir a partir de la <a href="http://geoladris.readthedocs.io/es/latest/user/config/">documentación de la plataforma</a></p>
<p>A continuación se presentan una pequeña guia de aprendizaje para la configuración de nuevas capas.</p>
<h2 id="configuracion-de-una-nueva-capa">Configuración de una nueva capa</h2>
<p>La definición de las capas a mostrar en el Portal se encuentra en el fichero <code>layers.json</code>.</p>
<p>Contiene la información para asociar los elementos de la interfaz de usuario (panel con la lista de capas en la parte izquierda de la página) con las capas WMS publicadas en GeoServer, personalizar las leyendas, y definir cuáles de las capas son interrogables. También clasifica las capas por grupos.</p>
<p>El formato utilizado para este fichero de configuración es JSON (JavaScript Object Notation), que es un formato para la representación de datos. Está fuera del objetivo de esta guía el aprendizaje de JSON, pero se exponen a continuación algunas nociones básicas:</p>
<ul>
<li>
<p>Los valores en JSON pueden ser: números, cadenas de carácteres, booleanos, arrays, objetos y el valor nulo. Por ejemplo: 13, "hola mundo", true, [12, 5, 2], {"id":3}.</p>
</li>
<li>
<p>Los objetos están delimitados por llaves (<code>{}</code>) y contienen una serie de pares atributo-valor separados por comas. Los pares atributo/valor consisten en un nombre de propiedad entrecomillado, dos puntos y el valor. Por ejemplo podemos tener el siguiente elemento:</p>
<div class="codehilite"><pre><span></span>{
    &quot;id&quot;:12,
    &quot;nombre&quot;:&quot;paco&quot;,
    &quot;edad&quot;:55
}
</pre></div>


</li>
</ul>
<p>o incluso un elemento dentro de otro:</p>
<div class="codehilite"><pre><span></span>{
    &quot;empresa&quot;:&quot;zapatos smith&quot;,
    &quot;propietario&quot;:{
        &quot;id&quot;:12,
        &quot;nombre&quot;:&quot;john smith&quot;,
        &quot;edad&quot;:55
    },
    &quot;pais&quot;:&quot;Argentina&quot;
}
</pre></div>


<ul>
<li>Los arrays especifican sus valores entre corchetes ([]) y separados por comas.<div class="codehilite"><pre><span></span><span class="k">[1, 2, 3, 4, 5]</span>

<span class="na">[</span>
    <span class="na">{</span>
        <span class="na">&quot;id&quot;:12,</span>
        <span class="na">&quot;nombre&quot;:&quot;john smith&quot;,</span>
        <span class="na">&quot;edad&quot;:34</span>
    <span class="na">},</span>
    <span class="na">{</span>
        <span class="na">&quot;id&quot;:12,</span>
        <span class="na">&quot;nombre&quot;:&quot;sarah smith&quot;,</span>
        <span class="na">&quot;edad&quot;:22</span>
    <span class="na">},</span>
    <span class="na">{</span>
        <span class="na">&quot;id&quot;:12,</span>
        <span class="na">&quot;nombre&quot;:&quot;Clark Kent&quot;,</span>
        <span class="na">&quot;edad&quot;:43</span>
    <span class="na">}</span>
<span class="na">]</span>
</pre></div>


</li>
</ul>
<p>Algunos recursos JSON:</p>
<ul>
<li><a href="http://www.json.org/">Introducción al formato JSON</a></li>
<li><a href="http://jsonformatter.curiousconcept.com/">Validador de JSON</a></li>
<li>Validador en línea de comandos: <code>python -mjson.tool &lt;fichero.json&gt;</code></li>
</ul>
<p>El fichero <code>layers.json</code> contiene tres secciones:</p>
<ul>
<li><code>wmsLayers</code></li>
<li><code>portalLayers</code></li>
<li><code>groups</code></li>
</ul>
<p>En este apartado vamos a realizar dos ejercicios:</p>
<ul>
<li>
<p>En primer lugar, vamos a añadir la capa de límites administrativos al grupo existente de "admin_areas".</p>
</li>
<li>
<p>En segundo lugar, añadiremos la capa "roads" en un nuevo grupo de capas.</p>
</li>
</ul>
<h2 id="conexion-wms">Conexión WMS</h2>
<p>Cada "wmsLayer" se corresponde con una de las capas publicadas en GeoServer, y describe la manera de conectarse al servidor para obtener los datos:</p>
<div class="codehilite"><pre><span></span>      &quot;wmsLayers&quot;: [
         {
          &quot;id&quot;: &quot;limites_administrativos&quot;,
          &quot;baseUrl&quot;: &quot;http://172.16.250.131/geoserver/gwc/service/wms&quot;,
          &quot;wmsName&quot;: &quot;capacitacion:limites_administrativos&quot;,
          &quot;imageFormat&quot;: &quot;image/png&quot;,
          &quot;visible&quot;: true
        }
      ],
</pre></div>


<ul>
<li>
<p>Es posible copiar y pegar un elemento existente y reemplazar :</p>
</li>
<li>
<p>el nuevo "id" será distinto a todos los otros, por ejemplo: "limites_administrativos".</p>
</li>
<li>el nuevo "wmsName" será "capacitacion:limites_administrativos" (el nombre de la capa publicada en GeoServer).</li>
<li>la baseUrl debe apuntar al servidor geoserver donde hemos cargado la capa.</li>
</ul>
<h2 id="capas-del-portal">Capas del portal</h2>
<p>Cada "portalLayer" representa una capa en el árbol de capas del portal y por tanto añade nuevos datos necesarios para mostrar la información en la interfaz gráfica.</p>
<div class="codehilite"><pre><span></span>          &quot;portalLayers&quot;: [
            {
              &quot;id&quot;: &quot;limites_administrativos&quot;,
              &quot;active&quot;: true,
              &quot;label&quot;: &quot;<span class="cp">${</span><span class="n">limites_administrativos</span><span class="cp">}</span>&quot;,
              &quot;infoFile&quot;: &quot;limites_def.html&quot;,
              &quot;layers&quot;: [&quot;country&quot;],
              &quot;inlineLegendUrl&quot;: &quot;http://172.16.250.131/geoserver/wms?REQUEST=GetLegendGraphic<span class="err">&amp;</span>VERSION=1.0.0<span class="err">&amp;</span>FORMAT=image/png<span class="err">&amp;</span>WIDTH=20<span class="err">&amp;</span>HEIGHT=20<span class="err">&amp;</span>LAYER=unredd:country<span class="err">&amp;</span>TRANSPARENT=true&quot;
            }
          ],
</pre></div>


<ul>
<li>
<p>Añadir un nuevo objeto en "context", de igual estructura y valores que "country", excepto los siguientes cambios:</p>
</li>
<li>
<p>el nuevo "id" será "regions".</p>
</li>
<li>como "label" se utilizará "${limites_administrativos}". De nuevo, esta etiqueta de sintaxis ${...} será sustituida por un texto en el idioma que
    corresponda, según los contenidos de "messages". Es la etiqueta que se mostrará en la interfaz gráfica.</li>
<li>en "infoFile" pondremos "administrative_boundaries_def.html". Esto creará un enlace a un documento con información sobre
    los datos (localizado en :file:<code>static/loc/&lt;idioma&gt;/html/</code>).</li>
<li>en "layers" pondremos ["limites_administrativos"], haciendo referencia al nuevo <em>layer</em>.</li>
<li>en "inlineLegendUrl" estableceremos el parámetro LAYER así <code>LAYER=capacitacion:limites_administrativos</code>. Esto generará
    una imagen con la leyenda.</li>
</ul>
<h2 id="grupos">Grupos</h2>
<p>Los "Groups" son una estructura recursiva (multinivel) para agrupar visualmente las capas en el panel.
El "group" de primer nivel construye cada uno de los grupos de capas en forma de persiana desplegable, conteniendo una lista de
"items" que hacen referencia a los contextos definidos anteriormente.</p>
<div class="codehilite"><pre><span></span>&quot;groups&quot; : [
    {
        &quot;id&quot; : &quot;admin&quot;,
        &quot;label&quot; : &quot;<span class="cp">${</span><span class="n">admin_areas</span><span class="cp">}</span>&quot;,
        &quot;items&quot; : [ &quot;countryBoundaries&quot;, &quot;provinces&quot; ]
    },
    ...
]
</pre></div>


<p>Nótese que en la propiedad "items", se hace referencia a las "portalLayers" definidas anteriormente. También, es posible dentro de dicha propiedad, añadir varios subgrupos de manera que las capas contenidas en éstos se visualicen dentro de una misma pestaña, pero agrupados visualmente bajo un título.</p>
<div class="codehilite"><pre><span></span>&quot;groups&quot; : [
    {
        &quot;id&quot; : &quot;admin&quot;,
        &quot;label&quot; : &quot;<span class="cp">${</span><span class="n">admin_areas</span><span class="cp">}</span>&quot;,
        &quot;items&quot; : [
            {
                &quot;id&quot; : &quot;admin1&quot;,
                &quot;label&quot; : &quot;Nacional&quot;,
                &quot;items&quot;: [&quot;limite_nacional&quot;]
            }, {
                &quot;id&quot; : &quot;admin2&quot;,
                &quot;label&quot; : &quot;Regional&quot;,
                &quot;items&quot;: [ &quot;provincias&quot; ]
            }
        ]
    },
    ...
]
</pre></div>


<ul>
<li>
<p>Añadir un nuevo elemento <code>{ "context": "limites_administrativos" }</code> a continuación de <code>{ "context": "country" }</code>. Esto incluirá la capa en el grupo de áreas administrativas.</p>
</li>
<li>
<p>Finalmente, utilizar un validador JSON, para comprobar que la sintaxis del nuevo <code>layers.json</code> es correcta, y recargar la página.</p>
</li>
</ul>
<h2 id="configuracion-de-un-nuevo-grupo-de-capas">Configuración de un nuevo grupo de capas</h2>
<p>Repetiremos el ejercicio anterior para añadir la capa de ciudades, teniendo en cuenta que:</p>
<ul>
<li>
<p>Para el nuevo "layer", usaremos el id "ciudades" y la capa wms "capacitacion:ciudades". Además, añadiremos un nuevo atributo <code>"legend": "ciudades.png"</code> para mostrar la leyenda de la capa. Este atributo hace referencia a una imagen localizada en :file:<code>static/loc/&lt;idioma&gt;/images/</code>.</p>
</li>
<li>
<p>En el nuevo "context", será más sencillo, sólo contendrá los tres elementos <code>"id": "roads", "label": "${ciudades}", "layers": ["ciudades"]</code>.</p>
</li>
<li>
<p>En "contextGroups", crearemos un nuevo grupo llamado "otros", con esta sintaxis:</p>
<div class="codehilite"><pre><span></span>  {
    &quot;group&quot;: {
      &quot;label&quot;: &quot;<span class="cp">${</span><span class="n">other</span><span class="cp">}</span>&quot;,
      &quot;items&quot;: [
      { &quot;context&quot;: &quot;roads&quot; }
      ]
  }
</pre></div>


</li>
<li>
<p>Tras validar el JSON, y recargar la página, obtendremos la capa de carreteras bajo el nuevo grupo "Otros".</p>
</li>
</ul>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../geoserver/" title="Publicación de datos en GeoServer" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Publicación de datos en GeoServer
              </span>
            </div>
          </a>
        
        
          <a href="../optimization/" title="Optimizaciones" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Optimizaciones
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application-07b0fbb49b.js"></script>
      
      
      <script>app.initialize({url:{base:".."}})</script>
      
    
    
      
    
  </body>
</html>